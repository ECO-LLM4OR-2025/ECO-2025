You are an expert operations research analyst. Based on the detailed diagnostic evaluation below, please generate an improved Gurobi solution for this optimization problem.

    ## Problem Description:
    The Aircraft Landing Problem (ALP) is the problem of deciding a landing time on an appropriate runway for each aircraft in a given set of aircraft such that each aircraft lands within a predetermined time window; and separation criteria between the landing of an aircraft, and the landing of all successive aircraft, are respected. We are given the earliest landing time, latest landing time, target landing time, and penalties for landing before or after the target landing time for each aircraft. There is also a separation time that represents the minimum time required between the landing of two aircraft. The objective of the problem is to minimize the total penalties of landing before or after the target time for each aircraft. The problem includes several constraints. The order constraint ensures that the aircrafts land in a specific order. The separation constraint ensures that there is enough separation time between the landing of aircraft. The lower and upper time window constraints ensure that each aircraft lands within its respective earliest and latest time windows.
Parameters: {"EarliestLanding": [1, 3, 5], "LatestLanding": [10, 12, 15], "TargetLanding": [4, 8, 14], "PenaltyAfterTarget": [10, 20, 30], "PenaltyBeforeTarget": [5, 10, 15], "SeparationTime": [[0, 2, 3], [2, 0, 4], [3, 4, 0]]}

    ## Current Iteration: 2

    ## Diagnostic Evaluation Results:
    **DIMENSION 1 – Definition Consistency**  
Diagnosis: The code faithfully mirrors the ALP’s data definitions. Variables t[i], e[i], l[i] correspond to landing times and early/late deviations as described. The parameters EarliestLanding, LatestLanding, TargetLanding, PenBefore, PenAfter, and SeparationTime exactly match the problem statement’s values for the three aircraft. The model’s scope is limited to three aircraft as intended.  
Issues Found:  
• None.  
Confidence: High  

**DIMENSION 2 – Structural Soundness**  
Diagnosis:  
- The objective is correctly formulated as a minimization of total early/late‐penalty costs.  
- Time‐window constraints enforce the given earliest/latest landing times.  
- Deviation constraints capture |t[i] – TargetLanding[i]| via e[i], l[i] in a linear fashion.  
- Separation constraints t[j] – t[i] ≥ sep for (i,j) pairs enforce the required minimum headway.  
- All variables are continuous where they belong (t unbounded but constrained, e,l ≥ 0).  
- The problem is purely a linear program.  

Potential caveat: The code assumes a fixed landing order (1→2→3) via listing only (1,2), (1,3), (2,3). If in a general ALP the landing sequence is not predetermined, one would need binary variables to choose ordering for each pair. However, given the “order constraint” is stated as predetermined, the current approach is consistent.  
Issues Found:  
• None (given a fixed sequence).  
Confidence: High  

**DIMENSION 3 – Numerical Validity**  
Diagnosis:  
- Analytically the LP is bounded and feasible; one can verify by inspection that each aircraft can land within its window with the required separations.  
- No coefficients are pathological; right‐hand sides and penalties are well‐scaled.  
- The failure to produce an optimal value arises not from model infeasibility or unboundedness, but from an environment issue: the gurobipy library is not installed or not found at runtime.  
Issues Found:  
• The import of gurobipy fails, leading to an immediate exit (“Error: gurobipy package not found…”).  
Confidence: High  

OVERALL ASSESSMENT  
Primary Issues:  
1. The solver library (gurobipy) is not installed or not accessible, causing the code to abort before building or solving the model.  
2. (Minor/conditional) If the ALP’s landing order is not actually predetermined by aircraft IDs, the model lacks binary ordering variables and corresponding “either-or” separation constraints.  

Recommended Actions:  
1. Install or configure the Gurobi Python interface. E.g.  
   • Run `pip install gurobipy` (with a valid Gurobi license) or configure the environment to point to the Gurobi installation.  
   • Verify by executing a simple `import gurobipy` in a Python REPL.  
2. (If needed for a non-fixed sequence variant)  
   • Introduce binary variables x[i,j] to decide landing order between each pair.  
   • Replace the fixed‐pair separation constraints with big-M constraints of the form  
      t[j] – t[i] ≥ sep[i,j] – M·(1−x[i,j])  
      t[i] – t[j] ≥ sep[j,i] – M·x[i,j]  
   • Add x[i,j] + x[j,i] = 1 for all i≠j.  

Once gurobipy is properly installed, re-run the script and confirm that an optimal solution (with a reasonable penalty cost) is obtained.

    ## Current 5element to Improve:
    No 5element_description

    ## Current Solution to Improve:
    ```python
    import sys

# 1. Import Gurobi with error handling
try:
    import gurobipy as gp
    from gurobipy import GRB
except ImportError:
    sys.stderr.write("Error: gurobipy package not found. Please install gurobipy and ensure you have a valid license.\n")
    sys.exit(1)

def main():
    # 2. Data definition
    I = [1, 2, 3]
    EarliestLanding = {1: 1,  2: 3,  3: 5}
    LatestLanding   = {1: 10, 2: 12, 3: 15}
    TargetLanding   = {1: 4,  2: 8,  3: 14}
    PenBefore       = {1: 5,  2: 10, 3: 15}
    PenAfter        = {1: 10, 2: 20, 3: 30}
    SeparationTime  = {
        (1,2): 2, (1,3): 3,
        (2,3): 4
    }

    try:
        # 3. Create model
        model = gp.Model("AircraftLanding")

        # 4. Decision variables
        #    t[i] = landing time (real, unbounded, time-windows enforced by constraints)
        #    e[i], l[i] = early/late deviations (nonnegative)
        t = model.addVars(I, lb=-gp.INFINITY, ub=gp.INFINITY, name="t")
        e = model.addVars(I, lb=0.0, name="e")
        l = model.addVars(I, lb=0.0, name="l")

        # 5. Time-window constraints
        for i in I:
            model.addConstr(t[i] >= EarliestLanding[i], name=f"earliest_{i}")
            model.addConstr(t[i] <= LatestLanding[i],   name=f"latest_{i}")

        # 6. Separation constraints (i must land before j for i<j)
        for (i, j), sep in SeparationTime.items():
            model.addConstr(t[j] - t[i] >= sep, name=f"sep_{i}_{j}")

        # 7. Deviation constraints (absolute deviation from target)
        for i in I:
            model.addConstr(e[i] >= TargetLanding[i] - t[i], name=f"dev_early_{i}")
            model.addConstr(l[i] >= t[i] - TargetLanding[i], name=f"dev_late_{i}")

        # 8. Objective: minimize total early/late penalties
        obj = gp.quicksum(PenBefore[i] * e[i] + PenAfter[i] * l[i] for i in I)
        model.setObjective(obj, GRB.MINIMIZE)

        # Optional: silence Gurobi output or control log level
        # model.Params.OutputFlag = 0

        # 9. Optimize with error handling
        model.optimize()

    except gp.GurobiError as ge:
        sys.stderr.write(f"Gurobi error: {ge}\n")
        sys.exit(1)

    # 10. Check status and write result
    if model.Status == GRB.OPTIMAL:
        optimal_value = model.ObjVal
        try:
            with open("ref_optimal_value.txt", "w") as fout:
                fout.write(str(optimal_value))
        except IOError as ioe:
            sys.stderr.write(f"File write error: {ioe}\n")
            sys.exit(1)
    else:
        sys.stderr.write("Optimization did not reach an optimal solution.\n")
        sys.exit(1)

if __name__ == "__main__":
    main()
    ```

    ## Instructions for Improvement:

    Based on the diagnostic evaluation above, please generate a completely new and improved Gurobi code that addresses ALL identified issues. 

    **Requirements:**
    1. Address each issue identified in the diagnostic evaluation
    2. Ensure the code can run successfully without errors
    3. Save the final optimal value to 'ref_optimal_value.txt' (value only, no extra text)
    4. Use proper Gurobi syntax and best practices
    5. Include appropriate error handling
    6. Add clear comments explaining key modeling decisions

    **Code Generation Format:**
    First, provide a brief explanation of the key improvements you're making, then provide the complete code between ===== markers:

    Key Improvements:
    [Explain the main changes you're making to address the identified issues]

    =====
    import gurobipy as gp
    from gurobipy import GRB

    # Your improved code here
    # Make sure to save only the optimal value to 'ref_optimal_value.txt'
    =====

    Please ensure the generated code is complete, executable, and addresses all the issues identified in the diagnostic evaluation.
    