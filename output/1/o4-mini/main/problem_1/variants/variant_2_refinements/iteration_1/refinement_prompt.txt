You are an expert operations research analyst. Based on the detailed diagnostic evaluation below, please generate an improved Gurobi solution for this optimization problem.

    ## Problem Description:
    A marketing company is planning to allocate resources between two projects: $X$ and $Y$. The total resource allocation for both projects cannot exceed 1000 units due to budget constraints. Project $X$ requires a minimum excess of 200 units over project $Y$ to ensure its success. Each unit of resource allocation costs \$50 for project $X$ and \$30 for project $Y$. Both projects can only be allocated whole numbers of resources **(integer, ≥ 0)** due to the indivisible nature of these resources. Moreover, the maximum resource allocation for project X is 700 units **(integer, 0 to 700)** and for project Y is 500 units **(integer, 0 to 500)** due to operational constraints.

Given these conditions, what is the minimum cost (in dollars) required for resource allocation that satisfies all given constraints? Provide your answer rounded to the nearest dollar. 

Modeling Type: Integer Programming.

    ## Current Iteration: 1

    ## Diagnostic Evaluation Results:
    **DIMENSION 1 – Definition Consistency:**  
Diagnosis: The five‐element formulation exactly matches the verbal description.  
- Variables x_X and x_Y (in code as x and y, but named “x_X” and “x_Y”) cover the two projects.  
- Cost parameters (50, 30), capacity (1000), and minimum excess (200) are all correctly reflected.  
- Variable bounds 0 ≤ x_X ≤ 700 and 0 ≤ x_Y ≤ 500 are explicitly enforced.  
- No other entities (facilities, customers, etc.) are implied, so the scope and scale are correct.  
Issues Found: None  
Confidence: High  

**DIMENSION 2 – Structural Soundness:**  
Diagnosis:  
- Objective: correctly set to minimization of 50·x_X + 30·x_Y.  
- Constraints:  
  1. x_X + x_Y ≤ 1000 (total capacity)  
  2. x_X – x_Y ≥ 200 (minimum excess)  
  3. 0 ≤ x_X ≤ 700, integer; 0 ≤ x_Y ≤ 500, integer  
  All are necessary and none are redundant.  
- Model type: integer linear program, which is exactly appropriate.  
- Variable types: both integer, as required by the indivisibility assumption.  
Issues Found: None  
Confidence: High  

**DIMENSION 3 – Numerical Validity:**  
Diagnosis:  
- The solver finds x_Y = 0, x_X = 200 as optimal, giving cost 50·200 + 30·0 = \$10 000.  
- This matches the analytical minimum: with cheaper Y units one would like to use them, but x_X must exceed x_Y by 200, and pushing x_Y above 0 only increases total cost.  
- No signs of infeasibility or unboundedness; presolve correctly collapses the model.  
Issues Found: None  
Confidence: High  

OVERALL ASSESSMENT:  
Primary Issues: None – the model is correctly specified, structurally sound, and numerically valid.  
Recommended Actions: Proceed with this formulation. If sensitivity analysis is needed, consider varying cost coefficients or the MinExcess parameter, but no changes are required to obtain the stated minimum cost.

    ## Current 5element to Improve:
    Sets:
  P = {X, Y}  // set of projects

Variables:
  x_X ∈ Integer, 0 ≤ x_X ≤ 700  // allocation to project X
  x_Y ∈ Integer, 0 ≤ x_Y ≤ 500  // allocation to project Y

Parameters:
  cost_X = 50         // cost per unit for project X
  cost_Y = 30         // cost per unit for project Y
  TotalCap = 1000     // total available resource units
  MinExcess = 200     // minimum excess of X over Y

Constraints:
  1. x_X + x_Y ≤ TotalCap                     // budget constraint
  2. x_X - x_Y ≥ MinExcess                    // minimum excess requirement
  3. 0 ≤ x_X ≤ 700, integer; 0 ≤ x_Y ≤ 500, integer  // indivisible and operational limits

Objective:
  Minimize  cost_X * x_X + cost_Y * x_Y       // minimize total allocation cost

    ## Current Solution to Improve:
    ```python
    import gurobipy as gp
from gurobipy import GRB

# Create model
model = gp.Model()

# Decision variables
x = model.addVar(vtype=GRB.INTEGER, name="x_X", lb=0, ub=700)
y = model.addVar(vtype=GRB.INTEGER, name="x_Y", lb=0, ub=500)

# Constraints
model.addConstr(x + y <= 1000, name="total_resource")
model.addConstr(x - y >= 200, name="excess_requirement")

# Objective: minimize cost
model.setObjective(50 * x + 30 * y, GRB.MINIMIZE)

# Optimize
model.optimize()

# Write optimal value to file
with open('ref_optimal_value.txt', 'w') as f:
    f.write(f"{model.objVal:.0f}")
    ```

    ## Instructions for Improvement:

    Based on the diagnostic evaluation above, please generate a completely new and improved Gurobi code that addresses ALL identified issues. 

    **Requirements:**
    1. Address each issue identified in the diagnostic evaluation
    2. Ensure the code can run successfully without errors
    3. Save the final optimal value to 'ref_optimal_value.txt' (value only, no extra text)
    4. Use proper Gurobi syntax and best practices
    5. Include appropriate error handling
    6. Add clear comments explaining key modeling decisions

    **Code Generation Format:**
    First, provide a brief explanation of the key improvements you're making, then provide the complete code between ===== markers:

    Key Improvements:
    [Explain the main changes you're making to address the identified issues]

    =====
    import gurobipy as gp
    from gurobipy import GRB

    # Your improved code here
    # Make sure to save only the optimal value to 'ref_optimal_value.txt'
    =====

    Please ensure the generated code is complete, executable, and addresses all the issues identified in the diagnostic evaluation.
    