You are an expert operations research analyst. Based on the detailed diagnostic evaluation below, please generate an improved Gurobi solution for this optimization problem.

    ## Problem Description:
    A marketing company is planning to allocate resources between two projects: $X$ and $Y$. The total resource allocation for both projects cannot exceed 1000 units due to budget constraints. Project $X$ requires a minimum excess of 200 units over project $Y$ to ensure its success. Each unit of resource allocation costs \$50 for project $X$ and \$30 for project $Y$. Both projects can only be allocated whole numbers of resources **(integer, ≥ 0)** due to the indivisible nature of these resources. Moreover, the maximum resource allocation for project X is 700 units **(integer, 0 to 700)** and for project Y is 500 units **(integer, 0 to 500)** due to operational constraints.

Given these conditions, what is the minimum cost (in dollars) required for resource allocation that satisfies all given constraints? Provide your answer rounded to the nearest dollar. 

Modeling Type: Integer Programming.

    ## Current Iteration: 2

    ## Diagnostic Evaluation Results:
    **DIMENSION 1 - Definition Consistency:**  
Diagnosis: The code’s decision variables, parameters, and constraints match exactly the problem statement. “x_X” and “x_Y” are integer resource allocations for projects X and Y respectively. The parameters (COST_X=50, COST_Y=30, BUDGET=1000, EXCESS=200, MAX_X=700, MAX_Y=500) all align with the textual description. There are no extra entities or mis‐named objects.  
Issues Found: None  
Confidence: High  

**DIMENSION 2 - Structural Soundness:**  
Diagnosis:  
- Objective: correctly set to minimize total cost `50*x_X + 30*x_Y`.  
- Constraints:  
   • x_X + x_Y ≤ 1000 captures the total-resource limit  
   • x_X – x_Y ≥ 200 enforces the required excess of X over Y  
   • 0 ≤ x_X ≤ 700 and 0 ≤ x_Y ≤ 500 impose the stated operational caps  
- Model type: integer programming is appropriate since allocations must be whole units.  
- No constraints are missing or redundant.  
Issues Found: None  
Confidence: High  

**DIMENSION 3 - Numerical Validity:**  
Diagnosis:  
- The solver finds x_X=200, x_Y=0 ⇒ cost = 50·200 + 30·0 = 10,000, which is the smallest feasible cost given the constraints.  
- The solution is feasible and bounded; no numerical instabilities or infeasibilities occur.  
- The computed optimum (10,000) is consistent with a model that seeks the smallest resource deployment satisfying x_X–x_Y≥200.  
Issues Found: None  
Confidence: High  

OVERALL ASSESSMENT:  
Primary Issues: None – the model and implementation fully satisfy the problem specification, and the solution is correct.  
Recommended Actions:  
1. (Optional) Rename the parameter `BUDGET` to e.g. `RESOURCE_CAPACITY` to avoid ambiguity with monetary budgets.  
2. Remove the now‐unnecessary `model.update()` call (modern Gurobi versions auto‐integrate new variables).  
3. Maintain the current constraint and objective structure, as no logical or modeling errors have been detected.

    ## Current 5element to Improve:
    No 5element_description

    ## Current Solution to Improve:
    ```python
    import gurobipy as gp
from gurobipy import GRB

# Problem parameters
COST_X    = 50    # cost per unit for project X
COST_Y    = 30    # cost per unit for project Y
BUDGET    = 1000  # total available resources
EXCESS    = 200   # minimum x_X - x_Y
MAX_X     = 700   # max units for project X
MAX_Y     = 500   # max units for project Y
OUTPUT_FILE = 'ref_optimal_value.txt'

def main():
    try:
        # Create a new Gurobi model
        model = gp.Model("Resource_Allocation")
        
        # Optional: suppress Gurobi console output if not needed
        # model.Params.OutputFlag = 0
        
        # Decision variables
        # x_X: units to allocate to project X (integer, [0, MAX_X])
        # x_Y: units to allocate to project Y (integer, [0, MAX_Y])
        x_X = model.addVar(vtype=GRB.INTEGER, name="x_X", lb=0, ub=MAX_X)
        x_Y = model.addVar(vtype=GRB.INTEGER, name="x_Y", lb=0, ub=MAX_Y)
        
        # Integrate new variables
        model.update()
        
        # Add constraints
        # 1) Total allocation must not exceed budget
        model.addConstr(x_X + x_Y <= BUDGET, name="budget_constraint")
        # 2) Project X must exceed project Y by at least EXCESS units
        model.addConstr(x_X - x_Y >= EXCESS, name="excess_constraint")
        
        # Objective: minimize total cost
        model.setObjective(COST_X * x_X + COST_Y * x_Y, GRB.MINIMIZE)
        
        # Solve the model
        model.optimize()
        
        # Check if an optimal solution was found
        if model.Status != GRB.OPTIMAL:
            raise gp.GurobiError(f"Optimization ended with status {model.Status}, not OPTIMAL.")
        
        # Retrieve the optimal objective value (an integer)
        optimal_cost = int(model.ObjVal)
        
        # Write the result to file (value only)
        with open(OUTPUT_FILE, 'w') as f:
            f.write(str(optimal_cost))
    
    except gp.GurobiError as e:
        print(f"Gurobi error occurred: {e}")
    except Exception as e:
        print(f"An unexpected error occurred: {e}")

if __name__ == "__main__":
    main()
    ```

    ## Instructions for Improvement:

    Based on the diagnostic evaluation above, please generate a completely new and improved Gurobi code that addresses ALL identified issues. 

    **Requirements:**
    1. Address each issue identified in the diagnostic evaluation
    2. Ensure the code can run successfully without errors
    3. Save the final optimal value to 'ref_optimal_value.txt' (value only, no extra text)
    4. Use proper Gurobi syntax and best practices
    5. Include appropriate error handling
    6. Add clear comments explaining key modeling decisions

    **Code Generation Format:**
    First, provide a brief explanation of the key improvements you're making, then provide the complete code between ===== markers:

    Key Improvements:
    [Explain the main changes you're making to address the identified issues]

    =====
    import gurobipy as gp
    from gurobipy import GRB

    # Your improved code here
    # Make sure to save only the optimal value to 'ref_optimal_value.txt'
    =====

    Please ensure the generated code is complete, executable, and addresses all the issues identified in the diagnostic evaluation.
    