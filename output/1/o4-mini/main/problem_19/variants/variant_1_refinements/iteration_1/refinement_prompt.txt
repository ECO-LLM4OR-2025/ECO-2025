You are an expert operations research analyst. Based on the detailed diagnostic evaluation below, please generate an improved Gurobi solution for this optimization problem.

    ## Problem Description:
    A furniture store can choose to order chairs from three different manufacturers: A, B, and C. The cost of ordering each chair from manufacturer A is $50, from manufacturer B is $45, and from manufacturer C is $40. The store needs to minimize the total cost of the order.

Additionally, each order from manufacturer A will include 15 chairs, while each order from manufacturers B and C will include 10 chairs. The number of orders must be an integer. The store needs to order at least 100 chairs.

Each order from manufacturer A will include 15 chairs, while each order from manufacturers B and C will include 10 chairs. The store needs to order at most 500 chairs.

If the store decides to order chairs from manufacturer A, it must also order at least 10 chairs from manufacturer B.

Furthermore, if the store decides to order chairs from manufacturer B, it must also order chairs from manufacturer C.

    ## Current Iteration: 1

    ## Diagnostic Evaluation Results:
    **DIMENSION 1 - Definition Consistency:**  
Diagnosis: The five‐element description matches the narrative. The sets, decision variables, and parameters (chairs per order, cost per order, bounds on total chairs) all correspond exactly to the problem statement. All manufacturers (A, B, C) are represented, and the binary indicators y capture the “if‐then” logic as described.  
Issues Found: None  
Confidence: High  

**DIMENSION 2 - Structural Soundness:**  
Diagnosis:  
- Objective: correctly stated as a minimization of total cost (cost_per_order · number_of_orders).  
- Constraints:  
  • Total chairs between 100 and 500.  
  • Big-M linking (xᵢ ≤ M·yᵢ, xᵢ ≥ yᵢ) enforces consistency between order counts and binary indicators.  
  • Logical implications (y_A ≤ y_B, y_B ≤ y_C) enforce the “if you order from A then B” and “if from B then C” rules.  
- Variable types: x’s are integer (number of orders), y’s are binary — all appropriate.  
- No redundancies or omissions: the lower bounds xᵢ ≥ 0 are implicit in Gurobi’s defaults.  
Issues Found: None  
Confidence: High  

**DIMENSION 3 - Numerical Validity:**  
Diagnosis:  
- The solver finds an optimal cost of \$4,000, achieved by placing all ten required orders with C (10 orders × 10 chairs/order × \$40/chair = \$4,000).  
- This is both feasible (100 chairs, within the 100–500 range) and clearly optimal, since C has the lowest unit cost and the model’s logic allows ordering from C alone.  
- No indications of infeasibility or unboundedness; presolve and node statistics are clean.  
Issues Found: None  
Confidence: High  

**OVERALL ASSESSMENT:**  
Primary Issues: None  
Recommended Actions: None; the model is correctly specified, solves without issue, and the solution is intuitive and optimal.

    ## Current 5element to Improve:
    Sets:
- M = {A, B, C}, the set of manufacturers.

Variables:
- x_A, x_B, x_C ∈ ℤ₊: number of orders from manufacturers A, B, C.
- y_A, y_B, y_C ∈ {0,1}: 1 if we place at least one order from A, B, C, respectively; 0 otherwise.

Parameters:
- chairs_per_order: a_A = 15, a_B = 10, a_C = 10
- cost_per_order: c_A = 15*50 = 750, c_B = 10*45 = 450, c_C = 10*40 = 400
- L = 100 (minimum total chairs)
- U = 500 (maximum total chairs)

Constraints:
1. Total chairs between 100 and 500:
   15 x_A + 10 x_B + 10 x_C ≥ 100  
   15 x_A + 10 x_B + 10 x_C ≤ 500
2. Link order counts to binaries (big-M linking):
   x_A ≤ ⌊U/15⌋ y_A,   x_A ≥ y_A  
   x_B ≤ ⌊U/10⌋ y_B,    x_B ≥ y_B  
   x_C ≤ ⌊U/10⌋ y_C,    x_C ≥ y_C  
3. Logical implications:
   If we order from A then from B: y_A ≤ y_B  
   If we order from B then from C: y_B ≤ y_C  

Objective:
- Minimize total cost = 750 x_A + 450 x_B + 400 x_C

    ## Current Solution to Improve:
    ```python
    import gurobipy as gp
from gurobipy import GRB

def main():
    # Create model
    model = gp.Model()

    # Variables: number of orders (integer) and binary indicators
    xA = model.addVar(vtype=GRB.INTEGER, name="xA")
    xB = model.addVar(vtype=GRB.INTEGER, name="xB")
    xC = model.addVar(vtype=GRB.INTEGER, name="xC")
    yA = model.addVar(vtype=GRB.BINARY,  name="yA")
    yB = model.addVar(vtype=GRB.BINARY,  name="yB")
    yC = model.addVar(vtype=GRB.BINARY,  name="yC")

    # Parameters
    aA, aB, aC = 15, 10, 10
    cA, cB, cC = 750, 450, 400
    L, U = 100, 500

    # Constraints
    model.addConstr(aA*xA + aB*xB + aC*xC >= L, name="minChairs")
    model.addConstr(aA*xA + aB*xB + aC*xC <= U, name="maxChairs")

    # Big-M linking between x and y:
    model.addConstr(xA <= (U//aA) * yA, name="link_xA_yA")
    model.addConstr(xB <= (U//aB) * yB, name="link_xB_yB")
    model.addConstr(xC <= (U//aC) * yC, name="link_xC_yC")
    model.addConstr(xA >= yA,               name="min_xA_if_yA")
    model.addConstr(xB >= yB,               name="min_xB_if_yB")
    model.addConstr(xC >= yC,               name="min_xC_if_yC")

    # Logical implications
    model.addConstr(yA <= yB, name="ifA_then_B")
    model.addConstr(yB <= yC, name="ifB_then_C")

    # Objective: minimize total cost
    model.setObjective(cA*xA + cB*xB + cC*xC, GRB.MINIMIZE)

    # Optimize
    model.optimize()

    # Save optimal value
    if model.status == GRB.OPTIMAL:
        with open('ref_optimal_value.txt', 'w') as f:
            f.write(str(model.objVal))

if __name__ == "__main__":
    main()
    ```

    ## Instructions for Improvement:

    Based on the diagnostic evaluation above, please generate a completely new and improved Gurobi code that addresses ALL identified issues. 

    **Requirements:**
    1. Address each issue identified in the diagnostic evaluation
    2. Ensure the code can run successfully without errors
    3. Save the final optimal value to 'ref_optimal_value.txt' (value only, no extra text)
    4. Use proper Gurobi syntax and best practices
    5. Include appropriate error handling
    6. Add clear comments explaining key modeling decisions

    **Code Generation Format:**
    First, provide a brief explanation of the key improvements you're making, then provide the complete code between ===== markers:

    Key Improvements:
    [Explain the main changes you're making to address the identified issues]

    =====
    import gurobipy as gp
    from gurobipy import GRB

    # Your improved code here
    # Make sure to save only the optimal value to 'ref_optimal_value.txt'
    =====

    Please ensure the generated code is complete, executable, and addresses all the issues identified in the diagnostic evaluation.
    